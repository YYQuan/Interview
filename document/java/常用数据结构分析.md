# 常用数据结构分析



常用的有list, set, map

![è¿éåå¾çæè¿°](https://img-blog.csdn.net/20150625230138672)



对于这些Collections 来分析 主要有如下维度：

- 储存的形式 : 数组/链表/树状  ?
- 容量怎么决定，怎么扩容
- CRUD （create/read/update/del）



## List

### ArrayList





#### 存储的形式

从构造函数来看 ，直接就能看到就是数组来存储的。

![image-20210723101617462](https://i.loli.net/2021/07/23/a6gKEkoiPD1GxHw.png)



#### 容量大小

先从构造函数入手

![image-20210723102315615](https://i.loli.net/2021/07/23/T2NHsGlQFvUcwIm.png)

发现有两种情况：

- 一个空数组
- 由传参决定



初始的容量看到了。
接下来看 ，在crud 过程中 容量是怎么变化的。
这里只关注容量的改变。

##### 增时（扩容）：

![image-20210723104731286](https://i.loli.net/2021/07/23/83SaT2KmXfr4bZN.png)

默认最小容量是10

![image-20210723104756678](https://i.loli.net/2021/07/23/bokFAEmrut51VNX.png)

从下面的代码中 可以看出

- 最大容量  Integer.MAX
- 每次扩容   增加当前容量的 50%

![image-20210723174905279](https://i.loli.net/2021/07/23/RDojCshica9mTnQ.png)

看代码 ，这里有个疑问

Q：为啥数组的最大长度 的常量定义成 MAX_VALUE -8呢？ 而且在size 大于 MAX_VALUE_8
的情况下，仍然允许把size 设置成大于MAX_VALUE-8呢？

注释里有解释， 原因是因为 有些虚拟机 会给数组加一个头数据，会占8个字节。

也就是
有些虚拟机 数组的最大数量是 Integer.MAX 
有些是Integer.MAX -8

![image-20210723175525218](https://i.loli.net/2021/07/23/SHVPXdN1CGk6uew.png)

##### 缩容

从下面的代码中 可以知道
remove的操作是通过 copy来完成的
并没有做缩容

直接是把要删除的元素 后面的元素 当做一个整体 复制；



对于ArrayList来说 是没有缩容的操作的。除了clear之外；

![image-20210723175930571](https://i.loli.net/2021/07/23/SuBQUxrfHF3TzWn.png)

前面看到 add和remove都是通过System.arraycopy() 来完成的。
来分析一下System.arraycopy

##### System.arraycopy

这是个native函数。
各个参数 根据注释很好理解

![image-20210723180913752](https://i.loli.net/2021/07/23/QrqauxmAzokjFUX.png)

#### CRUD

根据上面对容量的分析 基本上就已经理解了ArrayList的增删改查了。



### LinkedList

LinkedList 和ArrayList使用上的最大区别就是
LinkedList可以当做队列来使用。
![image-20210723181553620](https://i.loli.net/2021/07/23/FUg4icX2VZAEs98.png)



#### 储存的形式

一眼就看出来  就是链表  而且是一个双向链表。
其实从 LinkedList 实现了 deque接口  就是猜到 内部是一个双向链接来实现的。

![image-20210723181732126](https://i.loli.net/2021/07/23/sF9fTNiK3SxR1ml.png)

![image-20210723181922765](https://i.loli.net/2021/07/23/KqAEVQGjJbvNitO.png)





#### 容量大小

从下图 可知，  linkedList 由于是链表来实现的 本身是没有容量的限制的。
但是由于 size是int型  所以 可以认为 LinkedList的容量的大小是 Integer.MAX



![image-20210723182302698](https://i.loli.net/2021/07/23/FdAwefPYLqJ4XCE.png)

![image-20210723182215106](https://i.loli.net/2021/07/23/6A4oO2WLYNqxrzU.png)

![image-20210723182159779](https://i.loli.net/2021/07/23/EbyX8xcBMCIdmeq.png)



#### CRUD

没啥好说的 ，就是链表的操作。

## Map

### HashMap

##### 储存的形式







### TreeMap



## Set

### HashSet

#### 储存的形式

HashSet的内部是用 HashMap来实现的。

![image-20210723182726640](https://i.loli.net/2021/07/23/9a2H7cZU8YWTmKi.png)

#### 容量的大小

#### CRUD







### TreeSet





## 







